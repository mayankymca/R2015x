# File: TeamEngineering-Security-MD-R417HF2-downgrade.mql
# Description: This file downgrades VPLM security data from R417 HF2 to R417 GA for One-Click
#
# MBH 15:02:16 Created file
# MBH 15:02:16 IR-331361-3DEXPERIENCER2015x : Ports and CX creation under a released Ref
# MBH 15:02:19 IR-352100-3DEXPERIENCER2015x : Resource set binding not possible for Owner role
# MBH 15:03:24 IR-360366-3DEXPERIENCER2015x : Resource set binding not possible for Owner role of a second company
# MBH 15:03:25 IR-358178-3DEXPERIENCER2015x : Demote from OBSOLETE to RELEASED not possible when transition exists

# IR-331361-3DEXPERIENCER2015x

mod rule VPLM_UNSECURED_REL
   login VPLMViewer key k2 create filter "(to.current.access[modify] == TRUE)";

mod policy "VPLM_SMB_CX_Definition"
  state DEFAULT
    login VPLMAdmin key ExtendedSingleCtxAccess read,modify,delete,checkout,checkin,lock,unlock,changeowner,promote,demote,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,show,reserve,unreserve
    login VPLMCreator key ExtendedSingleCtxModifyAccessOnAnyOrg1 modify,delete,checkin,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect single project filter "(!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.policy matchlist 'VPLM_SMB_Definition,VPLM_SMB_Definition_Document' ',') && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'IN_WORK,DEFAULT' ',') && (to[VPLMrel/PLMConnection/V_Owner].from.reservedby == context.user || to[VPLMrel/PLMConnection/V_Owner].from.reservedby == '') && expression[VPLMStrictLocking_Definition] && (!expression[VPLMStrictOwnership_Definition])"
    login VPLMCreator key ExtendedSingleCtxModifyAccessOnAnyOrg2 modify,delete,checkin,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect single project filter "(!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current != 'FROZEN')"
    login VPLMCreator key ExtendedSingleCtxModifyAccessOnAnyOrg3 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "(!expression[VPLMStrictOrgOwnership]) && (!(to[VPLMrel/PLMConnection/V_Owner].from.policy matchlist 'VPLM_SMB_Definition,VPLM_SMB_Definition_Document' ',')) && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'PRIVATE,REMOVED,DEFAULT,IN_WORK' ',')"
    login VPLMCreator key ExtendedSingleCtxModifyAccessOnSingleOrg1 modify,delete,checkin,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect single organization single project filter "(to[VPLMrel/PLMConnection/V_Owner].from.policy matchlist 'VPLM_SMB_Definition,VPLM_SMB_Definition_Document' ',') && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'IN_WORK,DEFAULT' ',') && (to[VPLMrel/PLMConnection/V_Owner].from.reservedby == context.user || to[VPLMrel/PLMConnection/V_Owner].from.reservedby == '') && expression[VPLMStrictLocking_Definition] && (!expression[VPLMStrictOwnership_Definition])"
    login VPLMCreator key ExtendedSingleCtxModifyAccessOnSingleOrg2 modify,delete,checkin,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect single organization single project filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current != 'FROZEN')"
    login VPLMCreator key ExtendedSingleCtxModifyAccessOnSingleOrg3 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "(!(to[VPLMrel/PLMConnection/V_Owner].from.policy matchlist 'VPLM_SMB_Definition,VPLM_SMB_Definition_Document' ',')) && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'PRIVATE,REMOVED,DEFAULT,IN_WORK' ',')"
    user VPLMCreator key ExtendedMultiCtxModifyAccessOnAnyOrg1 modify,delete,checkin,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect single project filter "expression[MultiContextualAuthoringAbility] && (!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.policy matchlist 'VPLM_SMB_Definition,VPLM_SMB_Definition_Document' ',') && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'IN_WORK,DEFAULT' ',') && (to[VPLMrel/PLMConnection/V_Owner].from.reservedby == context.user || to[VPLMrel/PLMConnection/V_Owner].from.reservedby == '') && expression[VPLMStrictLocking_Definition] && (!expression[VPLMStrictOwnership_Definition])"
    user VPLMCreator key ExtendedMultiCtxModifyAccessOnAnyOrg2 modify,delete,checkin,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect single project filter "expression[MultiContextualAuthoringAbility] && (!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current != 'FROZEN')"
    user VPLMCreator key ExtendedMultiCtxModifyAccessOnAnyOrg3 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "expression[MultiContextualAuthoringAbility] && (!expression[VPLMStrictOrgOwnership]) && (!(to[VPLMrel/PLMConnection/V_Owner].from.policy matchlist 'VPLM_SMB_Definition,VPLM_SMB_Definition_Document' ',')) && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'PRIVATE,REMOVED,DEFAULT,IN_WORK' ',')"
    user VPLMCreator key ExtendedMultiCtxModifyAccessOnSingleOrg1 modify,delete,checkin,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect single organization single project filter "expression[MultiContextualAuthoringAbility] && (to[VPLMrel/PLMConnection/V_Owner].from.policy matchlist 'VPLM_SMB_Definition,VPLM_SMB_Definition_Document' ',') && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'IN_WORK,DEFAULT' ',') && (to[VPLMrel/PLMConnection/V_Owner].from.reservedby == context.user || to[VPLMrel/PLMConnection/V_Owner].from.reservedby == '') && expression[VPLMStrictLocking_Definition] && (!expression[VPLMStrictOwnership_Definition])"
    user VPLMCreator key ExtendedMultiCtxModifyAccessOnSingleOrg2 modify,delete,checkin,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect single organization single project filter "expression[MultiContextualAuthoringAbility] && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current != 'FROZEN')"
    user VPLMCreator key ExtendedMultiCtxModifyAccessOnSingleOrg3 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "expression[MultiContextualAuthoringAbility] && (!(to[VPLMrel/PLMConnection/V_Owner].from.policy matchlist 'VPLM_SMB_Definition,VPLM_SMB_Definition_Document' ',')) && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'PRIVATE,REMOVED,DEFAULT,IN_WORK' ',')"
    login VPLMProjectLeader key ExtendedSingleCtxModifyAccessOnAnyOrg4 modify,checkin,changename,changetype,fromconnect,toconnect,todisconnect single project filter "(!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    login VPLMProjectLeader key ExtendedSingleCtxModifyAccessOnSingleOrg4 modify,checkin,changename,changetype,fromconnect,toconnect,todisconnect single organization single project filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    user VPLMProjectLeader key ExtendedMultiCtxModifyAccessOnAnyOrg4 modify,checkin,changename,changetype,fromconnect,toconnect,todisconnect single project filter "expression[MultiContextualAuthoringAbility] && (!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    user VPLMProjectLeader key ExtendedMultiCtxModifyAccessOnSingleOrg4 modify,checkin,changename,changetype,fromconnect,toconnect,todisconnect single organization single project filter "expression[MultiContextualAuthoringAbility] && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    login VPLMReleaseManager key ExtendedSingleCtxModifyAccess modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)";

mod policy VPLM_SMB_PORT_Definition
  state DEFAULT
    login VPLMAdmin key ExtendedSingleCtxAccess read,modify,delete,checkout,checkin,lock,unlock,changeowner,promote,demote,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,show,reserve,unreserve
    login VPLMCreator key ExtendedSingleCtxModifyAccessOnAnyOrg1 modify,delete,checkin,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect single project filter "(!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMPort/V_Owner].from.policy matchlist 'VPLM_SMB_Definition,VPLM_SMB_Definition_Document' ',') && (to[VPLMrel/PLMPort/V_Owner].from.current matchlist 'IN_WORK,DEFAULT' ',') && (to[VPLMrel/PLMPort/V_Owner].from.reservedby == context.user || to[VPLMrel/PLMPort/V_Owner].from.reservedby == '') && expression[VPLMStrictLocking_Definition] && (!expression[VPLMStrictOwnership_Definition])"
    login VPLMCreator key ExtendedSingleCtxModifyAccessOnAnyOrg2 modify,delete,checkin,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect single project filter "(!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMPort/V_Owner].from.policy matchlist 'VPLM_SMB_Definition,VPLM_SMB_Definition_Document' ',') && (to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE) && (to[VPLMrel/PLMPort/V_Owner].from.current != 'FROZEN')"
    login VPLMCreator key ExtendedSingleCtxModifyAccessOnSingleOrg1 modify,delete,checkin,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect single organization single project filter "(to[VPLMrel/PLMPort/V_Owner].from.policy matchlist 'VPLM_SMB_Definition,VPLM_SMB_Definition_Document' ',') && (to[VPLMrel/PLMPort/V_Owner].from.current matchlist 'IN_WORK,DEFAULT' ',') && (to[VPLMrel/PLMPort/V_Owner].from.reservedby == context.user || to[VPLMrel/PLMPort/V_Owner].from.reservedby == '') && expression[VPLMStrictLocking_Definition] && (!expression[VPLMStrictOwnership_Definition])"
    login VPLMCreator key ExtendedSingleCtxModifyAccessOnSingleOrg2 modify,delete,checkin,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect single organization single project filter "(to[VPLMrel/PLMPort/V_Owner].from.policy matchlist 'VPLM_SMB_Definition,VPLM_SMB_Definition_Document' ',') && (to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE) && (to[VPLMrel/PLMPort/V_Owner].from.current != 'FROZEN')"
    user VPLMCreator key ExtendedMultiCtxModifyAccessOnAnyOrg1 modify,delete,checkin,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect single project filter "expression[MultiContextualAuthoringAbility] && (!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMPort/V_Owner].from.policy matchlist 'VPLM_SMB_Definition,VPLM_SMB_Definition_Document' ',') && (to[VPLMrel/PLMPort/V_Owner].from.current matchlist 'IN_WORK,DEFAULT' ',') && (to[VPLMrel/PLMPort/V_Owner].from.reservedby == context.user || to[VPLMrel/PLMPort/V_Owner].from.reservedby == '') && expression[VPLMStrictLocking_Definition] && (!expression[VPLMStrictOwnership_Definition])"
    user VPLMCreator key ExtendedMultiCtxModifyAccessOnAnyOrg2 modify,delete,checkin,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect single project filter "expression[MultiContextualAuthoringAbility] && (!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMPort/V_Owner].from.policy matchlist 'VPLM_SMB_Definition,VPLM_SMB_Definition_Document' ',') && (to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE) && (to[VPLMrel/PLMPort/V_Owner].from.current != 'FROZEN')"
    user VPLMCreator key ExtendedMultiCtxModifyAccessOnSingleOrg1 modify,delete,checkin,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect single organization single project filter "expression[MultiContextualAuthoringAbility] && (to[VPLMrel/PLMPort/V_Owner].from.policy matchlist 'VPLM_SMB_Definition,VPLM_SMB_Definition_Document' ',') && (to[VPLMrel/PLMPort/V_Owner].from.current matchlist 'IN_WORK,DEFAULT' ',') && (to[VPLMrel/PLMPort/V_Owner].from.reservedby == context.user || to[VPLMrel/PLMPort/V_Owner].from.reservedby == '') && expression[VPLMStrictLocking_Definition] && (!expression[VPLMStrictOwnership_Definition])"
    user VPLMCreator key ExtendedMultiCtxModifyAccessOnSingleOrg2 modify,delete,checkin,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect single organization single project filter "expression[MultiContextualAuthoringAbility] && (to[VPLMrel/PLMPort/V_Owner].from.policy matchlist 'VPLM_SMB_Definition,VPLM_SMB_Definition_Document' ',') && (to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE) && (to[VPLMrel/PLMPort/V_Owner].from.current != 'FROZEN')"
    login VPLMProjectLeader key ExtendedSingleCtxModifyAccessOnAnyOrg3 modify,checkin,changename,changetype,fromconnect,toconnect,todisconnect single project filter "(!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE)"
    login VPLMProjectLeader key ExtendedSingleCtxModifyAccessOnSingleOrg3 modify,checkin,changename,changetype,fromconnect,toconnect,todisconnect single organization single project filter "(to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE)"
    user VPLMProjectLeader key ExtendedMultiCtxModifyAccessOnAnyOrg3 modify,checkin,changename,changetype,fromconnect,toconnect,todisconnect single project filter "expression[MultiContextualAuthoringAbility] && (!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE)"
    user VPLMProjectLeader key ExtendedMultiCtxModifyAccessOnSingleOrg3 modify,checkin,changename,changetype,fromconnect,toconnect,todisconnect single organization single project filter "expression[MultiContextualAuthoringAbility] && (to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE)"
    login VPLMReleaseManager key ExtendedSingleCtxModifyAccess modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve filter "(to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE)";

mod policy "VPLM_SMB_CX_Evaluation"
  state DEFAULT
    login VPLMAdmin key ExtendedSingleCtxAccess read,modify,delete,checkout,checkin,lock,unlock,changeowner,promote,demote,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,show,reserve,unreserve
    login VPLMExperimenter key ExtendedSingleCtxModifyAccessOnAnyOrg1 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "(!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    login VPLMExperimenter key ExtendedSingleCtxModifyAccessOnAnyOrg2 modify,checkin,lock,changename,changetype,fromconnect,toconnect,todisconnect,reserve single project filter "(!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.policy == 'VPLM_SMB_Evaluation') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'FROZEN,RELEASED' ',') && ((expression[VPLMStrictOwnership_Evaluation] && (to[VPLMrel/PLMConnection/V_Owner].from.owner == context.user)) || (!expression[VPLMStrictOwnership_Evaluation]))"
    login VPLMExperimenter key ExtendedSingleCtxModifyAccessOnAnyOrg4 modify,checkin,lock,changename,changetype,fromconnect,toconnect,todisconnect,reserve single project filter "(!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.policy != 'VPLM_SMB_Evaluation') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current != 'OBSOLETE')"
    login VPLMExperimenter key ExtendedSingleCtxModifyAccessOnSingleOrg1 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    login VPLMExperimenter key ExtendedSingleCtxModifyAccessOnSingleOrg2 modify,checkin,lock,changename,changetype,fromconnect,toconnect,todisconnect,reserve single organization single project filter "(to[VPLMrel/PLMConnection/V_Owner].from.policy == 'VPLM_SMB_Evaluation') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'FROZEN,RELEASED' ',') && ((expression[VPLMStrictOwnership_Evaluation] && (to[VPLMrel/PLMConnection/V_Owner].from.owner == context.user)) || (!expression[VPLMStrictOwnership_Evaluation]))"
    login VPLMExperimenter key ExtendedSingleCtxModifyAccessOnSingleOrg4 modify,checkin,lock,changename,changetype,fromconnect,toconnect,todisconnect,reserve single organization single project filter "(to[VPLMrel/PLMConnection/V_Owner].from.policy != 'VPLM_SMB_Evaluation') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current != 'OBSOLETE')"
    user VPLMExperimenter key ExtendedMultiCtxModifyAccessOnAnyOrg1 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "expression[MultiContextualAuthoringAbility] && (!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    user VPLMExperimenter key ExtendedMultiCtxModifyAccessOnAnyOrg2 modify,checkin,lock,changename,changetype,fromconnect,toconnect,todisconnect,reserve single project filter "expression[MultiContextualAuthoringAbility] && (!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.policy == 'VPLM_SMB_Evaluation') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'FROZEN,RELEASED' ',') && ((expression[VPLMStrictOwnership_Evaluation] && (to[VPLMrel/PLMConnection/V_Owner].from.owner == context.user)) || (!expression[VPLMStrictOwnership_Evaluation]))"
    user VPLMExperimenter key ExtendedMultiCtxModifyAccessOnAnyOrg4 modify,checkin,lock,changename,changetype,fromconnect,toconnect,todisconnect,reserve single project filter "expression[MultiContextualAuthoringAbility] && (!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.policy != 'VPLM_SMB_Evaluation') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current != 'OBSOLETE')"
    user VPLMExperimenter key ExtendedMultiCtxModifyAccessOnSingleOrg1 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "expression[MultiContextualAuthoringAbility] && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    user VPLMExperimenter key ExtendedMultiCtxModifyAccessOnSingleOrg2 modify,checkin,lock,changename,changetype,fromconnect,toconnect,todisconnect,reserve single organization single project filter "expression[MultiContextualAuthoringAbility] && (to[VPLMrel/PLMConnection/V_Owner].from.policy == 'VPLM_SMB_Evaluation') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'FROZEN,RELEASED' ',') && ((expression[VPLMStrictOwnership_Evaluation] && (to[VPLMrel/PLMConnection/V_Owner].from.owner == context.user)) || (!expression[VPLMStrictOwnership_Evaluation]))"
    user VPLMExperimenter key ExtendedMultiCtxModifyAccessOnSingleOrg4 modify,checkin,lock,changename,changetype,fromconnect,toconnect,todisconnect,reserve single organization single project filter "expression[MultiContextualAuthoringAbility] && (to[VPLMrel/PLMConnection/V_Owner].from.policy != 'VPLM_SMB_Evaluation') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current != 'OBSOLETE')"
    login VPLMReleaseManager key ExtendedSingleCtxModifyAccess modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)";

mod policy "VPLM_SMB_PORT_Evaluation"
  state DEFAULT
    login VPLMAdmin key ExtendedSingleCtxAccess read,modify,delete,checkout,checkin,lock,unlock,changeowner,promote,demote,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,show,reserve,unreserve
    login VPLMExperimenter key ExtendedSingleCtxModifyAccessOnAnyOrg modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "(!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMPort/V_Owner].from.policy == 'VPLM_SMB_Evaluation') && (to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE)"
    login VPLMExperimenter key ExtendedSingleCtxModifyAccessOnSingleOrg modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "(to[VPLMrel/PLMPort/V_Owner].from.policy == 'VPLM_SMB_Evaluation') && (to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE)"
    user VPLMExperimenter key ExtendedMultiCtxModifyAccessOnAnyOrg modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "expression[MultiContextualAuthoringAbility] && (!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMPort/V_Owner].from.policy == 'VPLM_SMB_Evaluation') && (to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE)"
    user VPLMExperimenter key ExtendedMultiCtxModifyAccessOnSingleOrg modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "expression[MultiContextualAuthoringAbility] && (to[VPLMrel/PLMPort/V_Owner].from.policy == 'VPLM_SMB_Evaluation') && (to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE)"
    login VPLMReleaseManager key ExtendedSingleCtxModifyAccess modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve filter "(to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE)";

mod policy "VPLM_SMB_CX_Resource"
  state DEFAULT
    login VPLMReleaseManager key ExtendedSingleCtxModifyAccess modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    login VPLMProjectLeader key ExtendedSingleCtxModifyAccessOnAnyOrg1 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "(!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.policy != 'VPLM_SMB_Resource') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'PRIVATE,REMOVED,DEFAULT,IN_WORK,FROZEN' ',')"
    login VPLMProjectLeader key ExtendedSingleCtxModifyAccessOnAnyOrg2 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "(!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    login VPLMProjectLeader key ExtendedSingleCtxModifyAccessOnSingleOrg1 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "(to[VPLMrel/PLMConnection/V_Owner].from.policy != 'VPLM_SMB_Resource') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'PRIVATE,REMOVED,DEFAULT,IN_WORK,FROZEN' ',')"
    login VPLMProjectLeader key ExtendedSingleCtxModifyAccessOnSingleOrg2 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    user VPLMProjectLeader key ExtendedMultiCtxModifyAccessOnAnyOrg1 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "expression[MultiContextualAuthoringAbility] && (!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.policy != 'VPLM_SMB_Resource') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'PRIVATE,REMOVED,DEFAULT,IN_WORK,FROZEN' ',')"
    user VPLMProjectLeader key ExtendedMultiCtxModifyAccessOnAnyOrg2 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "expression[MultiContextualAuthoringAbility] && (!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    user VPLMProjectLeader key ExtendedMultiCtxModifyAccessOnSingleOrg1 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "expression[MultiContextualAuthoringAbility] && (to[VPLMrel/PLMConnection/V_Owner].from.policy != 'VPLM_SMB_Resource') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'PRIVATE,REMOVED,DEFAULT,IN_WORK,FROZEN' ',')"
    user VPLMProjectLeader key ExtendedMultiCtxModifyAccessOnSingleOrg2 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "expression[MultiContextualAuthoringAbility] && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)";

mod policy "VPLM_SMB_PORT_Resource"
  state DEFAULT
    login VPLMReleaseManager key ExtendedSingleCtxModifyAccess modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve filter "(to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE)"
    login VPLMProjectLeader key ExtendedSingleCtxModifyAccessOnAnyOrg1 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "(!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMPort/V_Owner].from.policy != 'VPLM_SMB_Resource') && (to[VPLMrel/PLMPort/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMPort/V_Owner].from.current matchlist 'PRIVATE,REMOVED,DEFAULT,IN_WORK,FROZEN' ',')"
    login VPLMProjectLeader key ExtendedSingleCtxModifyAccessOnAnyOrg2 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "(!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE)"
    login VPLMProjectLeader key ExtendedSingleCtxModifyAccessOnSingleOrg1 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "(to[VPLMrel/PLMPort/V_Owner].from.policy != 'VPLM_SMB_Resource') && (to[VPLMrel/PLMPort/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMPort/V_Owner].from.current matchlist 'PRIVATE,REMOVED,DEFAULT,IN_WORK,FROZEN' ',')"
    login VPLMProjectLeader key ExtendedSingleCtxModifyAccessOnSingleOrg2 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "(to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE)"
    user VPLMProjectLeader key ExtendedMultiCtxModifyAccessOnAnyOrg1 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "expression[MultiContextualAuthoringAbility] && (!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMPort/V_Owner].from.policy != 'VPLM_SMB_Resource') && (to[VPLMrel/PLMPort/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMPort/V_Owner].from.current matchlist 'PRIVATE,REMOVED,DEFAULT,IN_WORK,FROZEN' ',')"
    user VPLMProjectLeader key ExtendedMultiCtxModifyAccessOnAnyOrg2 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "expression[MultiContextualAuthoringAbility] && (!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE)"
    user VPLMProjectLeader key ExtendedMultiCtxModifyAccessOnSingleOrg1 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "expression[MultiContextualAuthoringAbility] && (to[VPLMrel/PLMPort/V_Owner].from.policy != 'VPLM_SMB_Resource') && (to[VPLMrel/PLMPort/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMPort/V_Owner].from.current matchlist 'PRIVATE,REMOVED,DEFAULT,IN_WORK,FROZEN' ',')"
    user VPLMProjectLeader key ExtendedMultiCtxModifyAccessOnSingleOrg2 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "expression[MultiContextualAuthoringAbility] && (to[VPLMrel/PLMPort/V_Owner].from.current.access[modify] == TRUE)";

mod policy "VPLM_SMB_CX_Management"
  state DEFAULT
    login VPLMAdmin key ExtendedAdminAccess read,modify,delete,checkout,checkin,lock,unlock,changeowner,promote,demote,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,show,reserve,unreserve
    login VPLMViewer key ExtendedSingleCtxModifyAccessOnAnyOrg modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "(!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    login VPLMViewer key ExtendedSingleCtxModifyAccessOnSingleOrg modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    user VPLMViewer key ExtendedMultiCtxModifyAccessOnAnyOrg modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "expression[MultiContextualAuthoringAbility] && (!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    user VPLMViewer key ExtendedMultiCtxModifyAccessOnSingleOrg modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "expression[MultiContextualAuthoringAbility] && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    login VPLMExperimenter key ExtendedSingleCtxModifyAccessOnAnyOrg modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "(!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.policy != 'VPLM_SMB_Management') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'PRIVATE,REMOVED,DEFAULT,IN_WORK' ',')"
    login VPLMExperimenter key ExtendedSingleCtxModifyAccessOnSingleOrg modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "(to[VPLMrel/PLMConnection/V_Owner].from.policy != 'VPLM_SMB_Management') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'PRIVATE,REMOVED,DEFAULT,IN_WORK' ',')"
    user VPLMExperimenter key ExtendedMultiCtxModifyAccessOnAnyOrg modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "expression[MultiContextualAuthoringAbility] && (!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.policy != 'VPLM_SMB_Management') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'PRIVATE,REMOVED,DEFAULT,IN_WORK' ',')"
    user VPLMExperimenter key ExtendedMultiCtxModifyAccessOnSingleOrg modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "expression[MultiContextualAuthoringAbility] && (to[VPLMrel/PLMConnection/V_Owner].from.policy != 'VPLM_SMB_Management') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'PRIVATE,REMOVED,DEFAULT,IN_WORK' ',')"
    login VPLMProjectLeader key ExtendedSingleCtxModifyAccessOnAnyOrg modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "(!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.policy != 'VPLM_SMB_Management') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current == 'FROZEN')"
    login VPLMProjectLeader key ExtendedSingleCtxModifyAccessOnSingleOrg modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "(to[VPLMrel/PLMConnection/V_Owner].from.policy != 'VPLM_SMB_Management') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current == 'FROZEN')"
    user VPLMProjectLeader key ExtendedMultiCtxModifyAccessOnAnyOrg modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single project filter "expression[MultiContextualAuthoringAbility] && (!expression[VPLMStrictOrgOwnership]) && (to[VPLMrel/PLMConnection/V_Owner].from.policy != 'VPLM_SMB_Management') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current == 'FROZEN')"
    user VPLMProjectLeader key ExtendedMultiCtxModifyAccessOnSingleOrg modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve single organization single project filter "expression[MultiContextualAuthoringAbility] && (to[VPLMrel/PLMConnection/V_Owner].from.policy != 'VPLM_SMB_Management') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current == 'FROZEN')"
    login VPLMReleaseManager key ExtendedSingleCtxAccess modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve filter "(to[VPLMrel/PLMConnection/V_Owner].from.policy != 'VPLM_SMB_Management') && (to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE)";

mod policy "VPLM_SMB_CX_Task_Management"
  state DEFAULT
    login VPLMViewer key k4 modify,delete,checkin,lock,unlock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve,unreserve filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)";

mod policy "VPLM_SMB_CX_PostIt_Management"
  state DEFAULT
    login VPLMAdmin read,modify,delete,checkout,checkin,lock,unlock,changeowner,create,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,show,reserve,unreserve filter "to[VPLMrel/PLMConnection/V_Owner].from.type.derived != 'PLMActionBase'"
    login VPLMViewer key k4 modify,delete,checkin,lock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE) && to[VPLMrel/PLMConnection/V_Owner].from.type.derived != 'PLMActionBase'"
    login VPLMCreator key ExtendedActionAccesses_1 modify,delete,checkin,lock,unlock,changeowner,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve,unreserve filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE) && (type matchlist 'PLMChgPeer,PLMChgTaskInput,PLMChgAttachment' ',') && (to[VPLMrel/PLMConnection/V_Owner].from.current == 'Create')"
    login VPLMCreator key ExtendedActionAccesses_2 modify,delete,checkin,lock,unlock,changeowner,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve,unreserve filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE) && (type == 'PLMChgMAO')"
    login VPLMCreator key ExtendedActionAccesses_3 modify filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE) && (type == 'PLMChgTaskInput') && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'DesignWork,Review' ',')";
 
mod policy "VPLM_SMB_CX_DesignWS"
  state DEFAULT
    login VPLMAdmin modify,delete,checkin,lock,unlock,changeowner,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve,unreserve filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    login VPLMProjectLeader key ExtendedControlledAccesses modify,delete,checkin,lock,unlock,changeowner,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve,unreserve filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    login VPLMProjectAdministrator key ExtendedControlledAccesses modify,delete,checkin,lock,unlock,changeowner,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve,unreserve filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)";

mod policy "VPLM_SMB_CX_DesignPrj"
  state DEFAULT
    login VPLMAdmin modify,delete,checkin,lock,unlock,changeowner,create,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve,unreserve filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    login VPLMProjectLeader key ExtendedControlledAccesses modify,delete,checkin,lock,unlock,changeowner,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve,unreserve filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)"
    login VPLMProjectAdministrator key ExtendedControlledAccesses modify,delete,checkin,lock,unlock,changeowner,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve,unreserve filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)";

mod policy "VPLM_SMB_CX_ActionInputs"
  state DEFAULT
    login VPLMCreator key ExtendedControlledAccesses modify,delete,checkin,lock,unlock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve,unreserve filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current == 'Create')"
    login VPLMCreator key ExtendedControlledAccesses_2 modify filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE) && (type == 'PLMChgFamilyInput') && (to[VPLMrel/PLMConnection/V_Owner].from.current matchlist 'DesignWork,Review' ',')";

mod policy "VPLM_SMB_CX_ActionAttachments"
  state DEFAULT
    login VPLMCreator key ExtendedControlledAccesses modify,delete,checkin,lock,unlock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve,unreserve filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE) && (to[VPLMrel/PLMConnection/V_Owner].from.current == 'Create')";

mod policy "VPLM_SMB_CX_ActionApplicability"
  state DEFAULT
    login VPLMProjectLeader key ExtendedControlledAccesses modify,delete,checkin,lock,unlock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve,unreserve filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)";

mod policy "VPLM_SMB_CX_ActionImplementation"
  state DEFAULT
    login VPLMCreator key ExtendedControlledAccesses modify,delete,checkin,lock,unlock,changename,changetype,fromconnect,toconnect,fromdisconnect,todisconnect,reserve,unreserve filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[modify] == TRUE)";

# IR-352100-3DEXPERIENCER2015x

modify policy VPLM_PosDeliverableCnx
  state DEFAULT
    login VPLMTeamManager key ProjectResourceModifyAccess modify,delete,create,fromconnect,toconnect,fromdisconnect,todisconnect filter "(to[VPLMrel/PLMConnection/V_Owner].from.current.access[fromconnect] == TRUE)";

# IR-360366-3DEXPERIENCER2015x

modify policy VPLM_PosResourceRef
  state DEFAULT
    login VPLMTeamManager key ProjectResourceConnectAccess fromconnect,fromdisconnect related organization filter "name == context.role.parent"
    login VPLMLocalCrossOrgContextAccess key ProjectResourceReadAccess read,show related organization filter "name == context.role.parent";

# IR-358178-3DEXPERIENCER2015x 

modify policy VPLM_SMB_Definition
  state OBSOLETE
    remove login VPLMProjectLeader key ExtendedSingleCtxPromoteAccessOnSingleOrg promote,demote single organization single project inclusive reserve
    remove login VPLMProjectLeader key ExtendedSingleCtxPromoteAccessOnAnyOrg promote,demote single project inclusive reserve filter "(!expression[VPLMStrictOrgOwnership])";

modify policy VPLM_SMB_Definition_Document
  state OBSOLETE
    remove login VPLMProjectLeader key ExtendedSingleCtxPromoteAccessOnAnyOrg promote,demote single project inclusive reserve filter "(!expression[VPLMStrictOrgOwnership]) && (attribute[PLMDMTDocument.V_CheckedOutUser] == '')"
    remove login VPLMProjectLeader key ExtendedSingleCtxPromoteAccessOnSingleOrg promote,demote single organization single project inclusive reserve filter "(attribute[PLMDMTDocument.V_CheckedOutUser] == '')";

modify policy VPLM_SMB_Evaluation
  state OBSOLETE
    remove login VPLMProjectLeader key ExtendedSingleCtxPromoteAccessOnSingleOrg promote,demote single organization single project inclusive reserve
    remove login VPLMProjectLeader key ExtendedSingleCtxPromoteAccessOnAnyOrg promote,demote single project inclusive reserve filter "(!expression[VPLMStrictOrgOwnership])";

modify policy VPLM_SMB_Resource
  state OBSOLETE
    remove login VPLMProjectLeader key ExtendedSingleCtxPromoteAccessOnSingleOrg promote,demote single organization single project inclusive reserve
    remove login VPLMProjectLeader key ExtendedSingleCtxPromoteAccessOnAnyOrg promote,demote single project inclusive reserve filter "(!expression[VPLMStrictOrgOwnership])";

